<script setup>
import { markRaw } from 'vue'
import CardListVue from './common/CardList.vue'
import CompareDirVue from './control/CompareDir.vue'
import ControlHistoryVue from './control/ControlHistory.vue'
import DupCleanVue from './control/DupClean.vue'
import FilterVue from './control/Filter.vue'
import ListingVue from './control/Listing.vue'
import LogMonitorVue from './control/LogMonitor.vue'
import ParseVue from './control/Parse.vue'
import QtVue from './control/Qt.vue'
import ReplaceVue from './control/Replace.vue'
import SplitVue from './control/Split.vue'
import SplitConditionVue from './control/SplitCondition.vue'
import SimilarityVue from './control/Similarity.vue'
import ValidateColVue from './control/ValidateCol.vue'

Notification.requestPermission()
</script>

<script>


export default {
    data() {
      return {
        meta: null,
        currentSelection: null,
        cardList: [
          {
            id: markRaw(ValidateColVue),
            imgUrl : '',
            name : "í—¤ë” ê²€ì‚¬",
            description : 'ì—¬ëŸ¬ê°œì˜ íŒŒì¼ì˜ í—¤ë”ê°€ í†µì¼ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•´ì¤ë‹ˆë‹¤. ë¬¸ì œê°€ ìˆëŠ” íŒŒì¼ì€ íŒŒì¼ëª…ì„ ë³€ê²½í•˜ì—¬ ì•Œë ¤ì¤ë‹ˆë‹¤.'
          },
          {
            id: markRaw(SimilarityVue),
            imgUrl : '',
            name : "ìœ ì‚¬ë„ ê²€ì‚¬",
            description : 'ë‘ ë¬¸ì¥ì˜ BLEU ì ìˆ˜ë¥¼ ì‚°ì¶œí•˜ì—¬ ìœ ì‚¬ë„ columnì„ ì¶”ê°€í•´ ì¤ë‹ˆë‹¤.'
          },
          {
            id: markRaw(SplitVue),
            imgUrl : '',
            name : "ë¶„í• /í•©ì¹˜ê¸°/í•„í„°ë§",
            description : 'íŒŒì¼ì„ ë¶„í• ê¸°ì¤€ì— ë”°ë¼ì„œ ë¶„í• í•˜ê±°ë‚˜ í•©ì¹©ë‹ˆë‹¤. ë¬´íš¨ë¬¸ì¥ì„ ì œì™¸í•˜ê±°ë‚˜ ì¬ì •ë ¬í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.'
          },
          {
            id: markRaw(QtVue),
            imgUrl : '',
            name : 'ê¸°ê³„ê²€ìˆ˜',
            description : 'ê¸°ê³„ê²€ìˆ˜ë¥¼ í•©ë‹ˆë‹¤.'
          },
          {
            id: markRaw(ListingVue),
            imgUrl : '',
            name : 'íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ë§Œë“¤ê¸°',
            description : 'ì—‘ì…€ë¡œ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“­ë‹ˆë‹¤. ê° íŒŒì¼ì˜ ì´ ì–´ì ˆìˆ˜ë¥¼ ì¶”ê°€í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.'
          },
          {
            id: markRaw(CompareDirVue),
            imgUrl : '',
            name : 'í´ë” ë¹„êµ',
            description : 'ë‘ê°œì˜ í´ë”ì— ë“¤ì–´ê°€ ìˆëŠ” íŒŒì¼ëª…ì„ ì„œë¡œ ë¹„êµí•˜ì—¬ ì–´ëŠ í•œìª½ì—ë§Œ ì—†ëŠ” íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
          },
          {
            id: markRaw(SplitConditionVue),
            imgUrl : '',
            name : 'ìµœì¢…ë³¸ ì‘ì„±',
            description : 'Nì‚¬ ìµœì¢…ë³¸ ë§Œë“¤ê¸°'
          },
          {
            id: markRaw(DupCleanVue),
            imgUrl : '',
            name : 'ì¤‘ë³µ ì œê±°',
            description : 'ë¬¸ì¥ì„ ì •ë ¬í•˜ê³  ì¤‘ë³µì¸ ë¬¸ì¥ì„ í‘œì‹œí•©ë‹ˆë‹¤.'
          },
          {
            id: markRaw(FilterVue),
            imgUrl : '',
            name : 'ì¶”ì¶œ',
            description : 'ì—‘ì…€ íŒŒì¼ì—ì„œ ê°’ì„ ì½ì–´ì„œ íŒŒì¼ì„ ì¶”ì¶œí•˜ê±°ë‚˜ ì—‘ì…€ì˜ rowë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.'
          },
          {
            id: markRaw(ReplaceVue),
            imgUrl : '',
            name : 'ë‹¨ì–´ êµì²´',
            description : 'ì—‘ì…€ íŒŒì¼ì—ì„œ ê°’ì„ ì½ì–´ì„œ ë‹¨ì–´ë¥¼ ì¼ë¶€/ì „ì²´ êµì²´í•©ë‹ˆë‹¤.'
          },
          {
            id: markRaw(ParseVue),
            imgUrl : '',
            name : 'íŒŒì‹±',
            description : 'íŒŒì¼ì„ ì—‘ì…€ë¡œ íŒŒì‹±í•©ë‹ˆë‹¤. "ì„œë²„ì—ì„œëŠ” ë¶ˆê°€" í‘œì‹œê°€ ìˆëŠ” ê¸°ëŠ¥ì€ ê´€ë¦¬ìì—ê²Œ ì§ì ‘ ìš”ì²­ ë°”ëë‹ˆë‹¤.'
          },
        ]
      }
    },
    methods: {
      toggleShowTimeline(isShow) {
        if(typeof(isShow) == 'undefined') {
          this.$refs.controlHistory.$data.showTimeline = !this.$refs.controlHistory.$data.showTimeline
        } else {
          this.$refs.controlHistory.$data.showTimeline = isShow
        }
        
        if(this.$refs.controlHistory.$data.showTimeline) this.fetchMeta()
      },
      fetchMeta() {
        this.axios.get('/main/request/' + this.$route.params.timestamp + '/control')
        .then((res) => {
          res.data.meta.history = res.data.meta.history.reverse() // ìµœì‹ ìˆœ
          this.$data.meta = res.data.meta
        })
        .catch(this.handleError)
      }
    },
    mounted() {
      this.fetchMeta()
    }
}
</script>

<template>
<div>
  <h1 v-if="meta">{{ meta.filename + 'ë¡œ ë¬´ì—‡ì„ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?' }}</h1>
  
  <CardListVue v-model="currentSelection" :cardList="cardList"/>
  <component :is="currentSelection" v-on:toggleShowTimeline="toggleShowTimeline"></component>
  <div>
    <div class="container">
        <div class="mt-3">
          <button type="button" @click="toggleShowTimeline()" class="btn btn-blue">ğŸ” íˆìŠ¤í† ë¦¬</button>
        </div>
    </div>
  </div>
  <ControlHistoryVue ref="controlHistory" :meta="meta"></ControlHistoryVue>
  <LogMonitorVue></LogMonitorVue>
</div>
</template>


<style scoped>
.btn {
  width: 100%;
}
</style>